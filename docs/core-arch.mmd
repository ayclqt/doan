flowchart TD
 subgraph subGraph0["LangChain Framework"]
        VDB["Vector Database - Qdrant"]
        PROCESS["Xử lý truy vấn"]
        CONTEXT["Tạo ngữ cảnh"]
        LLM["Large Language Model"]
        POST["Xử lý hậu kỳ"]
  end
 subgraph subGraph1["Core Chatbot"]
        INPUT["Xử lý đầu vào"]
        USER["Người dùng"]
        subGraph0
        OUTPUT["Định dạng đầu ra"]
  end
 subgraph subGraph2["Dữ liệu"]
        EMBED["Text Embeddings"]
        PRODUCT[("Dữ liệu sản phẩm")]
  end
 subgraph subGraph3["Bảo mật"]
        SEC1["Kiểm tra đầu vào"]
        SEC2["Sandboxing LLM"]
  end
    USER -- Nhập câu hỏi --> INPUT
    INPUT -- Query --> PROCESS
    PROCESS -- Tìm kiếm tài liệu liên quan --> VDB
    VDB -- Trả về thông tin sản phẩm liên quan --> CONTEXT
    CONTEXT -- Chuyển prompt + ngữ cảnh --> LLM
    LLM -- Phản hồi thô --> POST
    POST -- Phản hồi đã được định dạng --> OUTPUT
    OUTPUT -- Trả lời --> USER
    PRODUCT -- Xử lý và Embedding --> EMBED
    EMBED -- Vector Embeddings --> VDB
    SEC1 -- Lọc nội dung không an toàn --> INPUT
    SEC2 -- Ngăn chặn Prompt Injection --> LLM

     VDB:::component
     PROCESS:::component
     CONTEXT:::component
     LLM:::component
     POST:::component
     INPUT:::component
     USER:::component
     OUTPUT:::component
     EMBED:::component
     PRODUCT:::component
     SEC1:::component
     SEC2:::component
    classDef component fill:#fff,stroke:#333,stroke-width:1px,rx:5px,ry:5px
