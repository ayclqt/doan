flowchart TB
    subgraph "Core Chatbot"
        direction TB
        
        subgraph "Input Processing"
            IP[Input Processor]
            NLU[Natural Language Understanding]
            IC[Intent Classification]
            NER[Named Entity Recognition]
        end
        
        subgraph "Knowledge Retrieval"
            RAG[Retrieval Augmented Generation]
            VS[Vector Search]
            CR[Context Ranking]
            KG[Knowledge Graph]
        end
        
        subgraph "LLM Integration"
            LLTE[LiteLLM Engine]
            MT[Model Translator]
            LC[LangChain Framework]
            PC[Prompt Constructor]
        end
        
        subgraph "Memory & Context"
            STM[Short-term Memory]
            LTM[Long-term Memory]
            CS[Conversation State]
            CT[Context Tracking]
        end
        
        subgraph "Response Generation"
            NLG[Natural Language Generation]
            RP[Response Planner]
            RR[Response Ranking]
            RT[Response Templates]
        end
        
        subgraph "Safety & Evaluation"
            CF[Content Filter]
            SB[Sandbox]
            EM[Evaluation Metrics]
            FB[Feedback Loop]
        end
    end
    
    IP --> NLU --> IC & NER
    IC --> RAG
    NER --> RAG
    
    RAG --> VS & CR & KG
    VS & CR & KG --> PC
    
    PC --> LC
    LC --> LLTE & MT
    LLTE --> NLG
    
    IC --> STM & LTM
    STM & LTM --> CS
    CS --> CT
    CT --> PC
    
    NLG --> RP
    RP --> RR
    RR --> RT
    
    NLG --> CF
    CF --> SB
    SB --> EM
    EM --> FB
    FB --> PC